<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.inspur.dsp.direct.dao.Processed.ProcessedClaimDataElementMapper">

    <!-- ClaimDataElementVO结果映射 -->
    <resultMap id="ClaimDataElementVOMap" type="com.inspur.dsp.direct.entity.vo.ClaimDataElementVO">
        <id column="dataid" property="dataid" jdbcType="VARCHAR"/>
        <result column="data_element_id" property="dataElementId" jdbcType="VARCHAR"/>
        <result column="status" property="status" jdbcType="VARCHAR"/>
        <result column="name" property="name" jdbcType="VARCHAR"/>
        <result column="definition" property="definition" jdbcType="LONGVARCHAR"/>
        <result column="datatype" property="datatype" jdbcType="VARCHAR"/>
        <result column="data_format" property="dataFormat" jdbcType="VARCHAR"/>
        <result column="value_domain" property="valueDomain" jdbcType="LONGVARCHAR"/>
        <result column="source_unit_code" property="sourceUnitCode" jdbcType="VARCHAR"/>
        <result column="source_unit_name" property="sourceUnitName" jdbcType="VARCHAR"/>
        <result column="publish_date" property="publishDate" jdbcType="TIMESTAMP"/>
        <result column="send_date" property="sendDate" jdbcType="TIMESTAMP"/>
        <result column="confirm_date" property="confirmDate" jdbcType="TIMESTAMP"/>
        <result column="collectunitqty" property="collectunitqty" jdbcType="INTEGER"/>
        <result column="remarks" property="remarks" jdbcType="LONGVARCHAR"/>
        <result column="create_date" property="createDate" jdbcType="TIMESTAMP"/>
        <result column="create_account" property="createAccount" jdbcType="VARCHAR"/>
        <result column="last_modify_date" property="lastModifyDate" jdbcType="TIMESTAMP"/>
        <result column="last_modify_account" property="lastModifyAccount" jdbcType="VARCHAR"/>
        <result column="collectunitnames" property="collectunitnames" jdbcType="LONGVARCHAR"/>
    </resultMap>

    <!-- 根据状态查询base_data_element表 -->
    <select id="selectBaseDataElementByStatus" parameterType="com.inspur.dsp.direct.entity.dto.GetDataElementDTO"
            resultMap="ClaimDataElementVOMap">
        SELECT
        dataid,
        data_element_id,
        status,
        name,
        definition,
        datatype,
        data_format,
        value_domain,
        source_unit_code,
        source_unit_name,
        publish_date,
        send_date,
        confirm_date,
        collectunitqty,
        remarks,
        create_date,
        create_account,
        last_modify_date,
        last_modify_account,
        collectunitnames
        FROM base_data_element
        <where>
            <if test="dto.status != null and status.size() > 0">
                AND status IN
                <foreach collection="status" item="statusItem" open="(" separator="," close=")">
                    #{statusItem}
                </foreach>
            </if>
<!--            <if test="status != null and status != ''">-->
<!--                AND status = #{status}-->
<!--            </if>-->
            <if test="senddateBegin != null and senddateEnd != null">
                AND send_date BETWEEN #{senddateBegin} AND #{senddateEnd}
            </if>
            <if test="keyword != null and keyword != ''">
                AND (name LIKE CONCAT('%', #{keyword}, '%') OR definition LIKE CONCAT('%', #{keyword}, '%'))
            </if>
        </where>
        ORDER BY send_date DESC
    </select>

</mapper>